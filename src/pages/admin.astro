---
import AppLayout from "../layouts/AppLayout.astro";
import { AdminViewWrapper } from "../components/admin/AdminViewWrapper";

// Get user from middleware (can be null if not logged in)
const user = Astro.locals.user;

// Check if user is selected and is admin
if (!user) {
  return Astro.redirect("/login");
}

if (user.app_role !== "admin") {
  return Astro.redirect("/dashboard");
}
---

<AppLayout title="Zarządzanie - DailyPath" user={user}>
  <div class="space-y-6">
    <div>
      <h1 class="text-3xl font-bold tracking-tight">Zarządzanie</h1>
      <p class="text-muted-foreground">Panel administracyjny systemu</p>
    </div>

    <AdminViewWrapper client:only="react" initialUser={user} />
  </div>
</AppLayout>

